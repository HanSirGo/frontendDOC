# 【网络协议】精讲IPV6报文格式！图解超赞超详细！！！

**1. IP协议的数据传递方式**

​      当发送方发送数据时，数据被分成一系列数据报，并且每个数据报都被分配一个IP地址。这个IP地址标识了该数据报的源和目的地，这样路由器就可以将数据报从一个网络节点传递到另一个网络节点。在传输过程中，每个数据报都被分成两个部分：头部和数据部分。头部包含了源IP地址、目的IP地址和其他必要的信息，如数据报的长度和类型等。数据部分则包含实际的数据内容。当数据报到达目的地时，它们将被重新组装成完整的数据，然后将其传递给目的应用程序。整个过程中，IP协议确保数据的可靠性和准确性，以便数据能够在网络中正确地传输。



**2. 互联网协议**

​      IPv4和IPv6都是互联网协议，用于在网络上传输数据。IPv4是互联网上使用最广泛的协议，但由于其地址空间的限制，IPv6被设计为IPv4的后继协议。

​      IPv4使用32位地址，而IPv6使用128位地址。这意味着IPv6可以提供比IPv4更大的地址空间，从而支持更多的设备和更多的互联网连接。IPv6还提供了更好的安全性和性能，因为它使用IPsec协议来提供端到端的加密和认证，并提供了更好的路由和多播支持。

​      虽然IPv4仍然是互联网上使用最广泛的协议，但IPv6正在逐渐取代它，并成为未来互联网的主要协议。



### 3. IPv6数据报文格式

![1719139331528](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\1719139331528.png)

**IPv6字段简要说明：**

| **中文名** | **英文名**          | **长度 bit（位）** | **解释**                                                     |
| ---------- | ------------------- | ------------------ | ------------------------------------------------------------ |
| 版本       | Version             | 4                  | IP 协议版本号，固定为 6                                      |
| 通信类型   | Traffic Class       | 8                  | 类似于 IPv4 中的 服务类型(TOS)                               |
| 流标签     | Flow Label          | 20                 | 识别某些需要特别处理的分组                                   |
| 载荷长度   | Payload Length      | 16                 | 类似于 IPv4 中的 总长度(Total  Length)，区别在于不含基本首部 |
| 下一头部   | Next Header         | 8                  | 类似于 IPv4 中的  协议(Protocol)                             |
| 跳数限制   | Hop Limit           | 8                  | 类似于 IPv4 中的 生存时间(TTL)                               |
| 源地址     | Source Address      | 128                | 源 IPv6 地址                                                 |
| 目的地址   | Destination Address | 128                | 目的 IPv6 地址                                               |
| 扩展首部   | Extension Header    | 可变               | 可选择继续使用 IPv4  中首部部分，详见下表                    |
| 数据       | Data                |                    | 报文数据部分                                                 |



| **先后顺序** | **扩展首部**   | **说明**                 |
| ------------ | -------------- | ------------------------ |
| 1            | 逐跳选项       | 针对路由器中的各种信息   |
| 2            | 目标选项       | 针对目标端的各种附加信息 |
| 3            | 路由           | 要访问的路由器列表       |
| 4            | 分段           | 数据报分段的管理         |
| 5            | 认证           | 验证发送方身份           |
| 6            | 加密的安全负荷 | 信息加密                 |



**IPv6字段细致说明：**

**版本(version) ：**占4位，指明协议版本，IPv6该字段为6。

**通信量类(traffic class) ：**占8位，区别不同的IPv6数据报的类别或优先级。

**流标号(flow label) ：**占20位。IPv6的一个新的机制是支持资源预分配，并且运行路由器把每一个数据报与一个给定的资源分配相联系。所谓“流”就是互联网上从特定源点到特定终点(单播或多播)的一系列数据报(如实时音频或视频传输)，而这个“流”所经过的路径上的路由器都保证指明的服务质量。所有属于同一个流的数据报都具有同样的流标号。因此流标号对于实时音频/视频数据的传送特别有用。对于传统的电子邮件或非实时数据。流标号没有用处，置为0即可。

**有效载荷长度(payload length) ：**占16位，指明IPv6数据报除基本首部以外的字节数(所有扩展首部都算在有效载荷之内)。

**下一个首部：** 占8位，相当于IPv4的协议字段或可选字段。当IPv6数据报没有扩展首部时，下一个首部字段的作用和IPv4的协议字段一样，它的值指出了基本首部后面的数据应交付给IP上面的哪一个高层协议(如6表示TCP，17表示UDP)。当出现扩展首部时，下一个首部字段的值就标识后面第一个扩展首部的类型。

**跳数限制(hop limit) ：**占8位。用来防止数据报在网络中无限期地存在。源点在每个数据报发出时即设定某个跳数限制，每个路由器在转发数据报时，要先将跳数限制字段中的值减1。当跳数限制的值为零时，就要丢弃这个数据报。

**源地址 ：**占128位。是数据报的发送端的IP地址。

**目的地址 ：**占128位，是数据报的接收端的IP地址。